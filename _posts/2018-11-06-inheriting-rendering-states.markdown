---
layout: post
title:  "Введение в OpenSceneGraph: Наследование состояний рендеринга"
date:   2018-11-06 10:05:00 +0300
categories: jekyll update
---

Набор состояний узла влияет на текущий узел и все его дочерние элементы. Например, атрибут osg::PolygonMode, установленный для узла transform1 из предыдущего примера будет применен ко всем дочерним элементам этого узла. Однако, дочерний узел может переопределять родительские атрибуты, то есть состояние рендеринга будет наследоваться от родительского узла, если дочерний узел не изменит поведение.

![](https://habrastorage.org/webt/ez/_c/4q/ez_c4qowpsmgjqwqmhtpu5noilm.png)

Иногда тербуется переопределить поведение узла в части применения аттрибутов. Например, в большинстве 3D-редакторов пользователь может загрузить несколько моделей и менять режим их отображения для всех загруженных моделей одновременно, независимо от того, каким образом они отображались ранее. Другими словами, все модели в редакторе должны наследовать единый атрибут независимо от того, как его задавали раньше для кажой из моделей. В OSG это может быть реализовано с помощью флага osg::StateAttribute::OVERRIDE, например

```cpp
stateset->StateAttribute(attr, osg::StateAttribute::OVERRIDE);
```

При установке режимов и режимов с атрибутами используются оператор побитового ИЛИ

```cpp
stateset->StateAttributeAndModes(attr, osg::StateAttribute::ON | osg::StateAttribute::OVERRIDE);
```

Кроме того, возможна и защита атрибута от переопределения - для этого он должен быть помечен флагом osg::StateAttribute::PROTECTED.

Имеется и третий флаг, osg::StateAttribute::INHERIT, который используется для того, чтобы отметить, что данный атрибут должен наследоваться из набора состояний родительского узла.

Приведем короткий пример использвание флагов OVERRIDE и PROTECTED. Корневой узел будет установлен в OVERRIDE, чтобы заставить все дочерние узлы наследовать его атрибуты и режимы. При этом дочерние узлы будут пытаться изменить свое состояние с помощью или без помощи флага PROTECTED, что будет приводить к различным результатам.